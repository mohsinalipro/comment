{"version":3,"sources":["js/model/CommentList.js","js/view/base.js","js/helper/getAvatar.js","js/view/commentListView.js","js/helper/generateUniqueId.js","js/helper/randomName.js","js/app.js"],"names":["commentList","id","username","text","child","parentId","comment","parent","push","_persistComments","updateComment","indexOf","find","listItem","deleted","updatedCommentList","filter","localStorage","setItem","JSON","stringify","storage","parse","getItem","elements","commentTextbox","document","querySelector","getAvatar","avatars","getInput","value","clearInput","renderCommentMarkup","commentText","renderControls","markup","insertAdjacentHTML","renderChildrenCommentMarkup","parentCommentId","generateUniqueId","uniqueId","Date","getTime","randomUsername","usernames","Math","floor","random","length","state","controlCommentList","randomId","CommentList","isChild","addComment","commentListView","undefined","addEventListener","e","keyCode","target","dataset","removeAttribute","preventDefault","tagName","btn","li","classList","contains","insertAdjacentElement","focus","setAttribute","confirm","deletedText","softDeleteComment","innerHTML","remove","window","readStorage","console","log","c","output"],"mappings":";;AMCA;;AAGA;;AAGA,ALPO,IAAMwB,QAAQ,GAAG;AGAxB,AFAA,AGAA,AJCIC,AEDJ,EFCIA,EGDEe,AFAAZ,AGAAgB,SHAS,GAAG,ADCA,EIDE,AJCAlB,EGDE,CCAC,EDAE,EFAnBE,CDCsB,CAACD,GIDvBiB,EDAAJ,EFAY,CAACtC,KDCC,CAAuB,ECDzB,CGAK,CHAS,EGAH,CDAJ,GAAM,KHCX,CADI;AKQxB,AFPI,AFAA,AGAA,AJCAF,EAAAA,IGDMyC,AFAAZ,AGAAgB,OHAO,ADCF,CGDG,CCAC,AJCFnB,CCDG,CEAC,CCAC,CACd,EDDiBgB,EHCA,CAACf,CGDL,ECAC,CDAUgB,CCExB,MDFa,ACAC,EDAlB,ACGI,AJFS,CAAuB,MIDlB,EAId,MAJc,EAKd,AJJS,MIDK,EAMd,MANc,CAAlB;ADEA,AFDI,AGQJ,AJVoB,AECxB,CFDO,QGGIF,ACOAI,KHRO,GECd,CCOgB,CAACC,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,MAAL,KAAgBH,SAAS,CAACI,MAArC,CAAD,CAAhB,6CHTgB;AIQpB,AFLC,AFDO,AGQP,CDXD,ACAA,WHGgB,8FAFI;AAGZ,aAAS,+FAHG;AAIZ,YAAQ,GECDT,ACOAI,4FHZK;AAKZ,ACJD,IHFc5C,AGER8B,QDIG,ACJK,GAAG,SAAXA,QAAW,2EDDJ;AAMZ,ACLgB,SAAMN,GDKd,YCLuBC,cAAT,CAAwBM,KAA9B;ADDJ,ACCI,CAAjB,EDDH;AASA,AFTA,SESOF,OAAO,CAAC3B,QAAD,AFTD,CESb;AACH,AFVgB,CEDjB;AIAA;AAGA,ANDQ,AGED,IAAM8B,KHFAhC,KGEU,CDSR4B,ECTW,GHFlB,GAAmB,EAAnB,CGEKI,UAAa,GAAM;AGEhC,ANHK,AGEDR,iBAASC,cAAT,CAAwBM,KAAxB,GAAgC,EAAhC;AACH,CAFM;AGOP;;+BNNe9B,IAAIC,UAAUC,MAAMC,OAAOC,UAAS;AMSnD,ANRQ,AGED,IGMD6C,AHNOjB,KGMF,CNRG3B,EMQA,EAAd,GNRqB,GAAG,GGEQ,GAAG,SAAtB2B,mBAAsB,CAAChC,EAAD,EAAKC,QAAL,EAAegC,WAAf,EAA4B9B,KAA5B,EAAmC+B,cAAnC,EAAsD;AGQzF,ANTYlC,AGER,MAAMmC,EHFEnC,EAAE,EAAFA,AGEI,EHHQ,qDGIeA,EADvB,iFAGY,wBAAUC,QAAV,CAHZ,2GAMcA,QANd,sCAOKgC,WAPL,6DASKC,cAAc,CAAClC,EAAD,CATnB,sEAAZ;AHDQC,AGgBR,GAACE,KHhBOF,AGgBR,IAAUsB,IHhBM,EAARtB,QAFY,CGkBDF,WAAT,CAAqBqC,kBAArB,CAAwC,YAAxC,EAAsDD,MAAtD,CAAV;AHfQjC,AGiBR,QHjBQA,CGiBDiC,GHjBK,EAAJjC,CGiBR,GHpBoB;AAIZC,AGiBX,CAnBM,OHEKA,KAAK,EAAE,CAAC,CAACA,KAJG;AMaxB,ANRYG,IMQN4C,INRM5C,MAAM,EAAE,CAAC,CAACF,IMQE,GAAG,CNbH,QMalB8C,kBAAqB,CAAAlD,EAAE,EAAI;AAC/B,ANRUI,MMQJC,ENRID,KMQG,GAAGmB,ANRE,EAARnB,aMQeoB,cAAT,CAAwBM,KAAxC;AACA,ANfsB,MMelB7B,CNfE,OMeM,GAAG,0BAAf;AACA,ANRM,AGeD,IAAMoC,EGPPc,KNROpD,GMQC,GAAG,KNRT,CAAiBQ,IAAjB,CAAsBF,GGeU,GAAG,CHfnC,QGeKgC,MGPX,qBHOyC,CAACrC,EAAD,EAAKC,QAAL,EAAegC,WAAf,EAA4BK,eAA5B,EAA6CJ,cAA7C,EAAgE;AGNzG,AHOE,MGPE,AHOIC,CGPHc,KAAK,AHOI,CGPHlD,WAAX,EAAwBkD,KAAK,CAAClD,WAAN,GAAoB,IAAIqD,oBAAJ,EAApB,KHSZpB,mBAAmB,CAAChC,EAAD,EAAKC,QAAL,EAAegC,WAAf,EAA4B,IAA5B,EAAkCC,cAAlC,CAFjB,0BAAZ;AHfI,AGoBJT,EAAAA,QAAQ,CHpBCjB,AGoBAkB,aAAT,GHpBI,qBGoBkCY,eAAtC,UAA2DF,kBAA3D,CAA8E,UAA9E,EAA0FD,MAA1F;AGVF,ANTG,AGoBJ,CAPM,KGJD9B,OAAJ,EAAa;AACX,QAAMgD,OAAO,GAAG,CAAC,CAACrD,EAAlB;AACAiD,IAAAA,KAAK,CAAClD,WAAN,CAAkBuD,UAAlB,CAA6BH,QAA7B,EAAuClD,QAAvC,EAAiDI,OAAjD,EAA0DgD,OAA1D,EAAmErD,EAAnE;AAEAuD,IAAAA,eAAe,CAACxB,UAAhB,ENXY/B,CMOD,CAMX,ENbgBE,MAAK;AACjB,UAAMO,aAAa,GAAG,KAAKV,WAAL,CAAiBW,OAAjB,CAAyBV,EAAzB,CAAtB,CADiB,CAGjB;AMWJA,IAAAA,EAAE,GACEuD,eAAe,CAAClB,2BAAhB,CACEc,QADF,EAEElD,QAFF,EAGEI,OAHF,EAIEL,EAJF,EAKEkC,cALF,CADF,GAQEqB,eAAe,CAACvB,mBAAhB,CAAoCmB,QAApC,EAA8ClD,QAA9C,EAAwDI,OAAxD,EAAiEmD,SAAjE,EAA4EtB,cAA5E,CARJ;AASD,ANnBK,WAAKnC,WAAL,CAAiBU,aAAjB,EAAgCP,IAAhC,GAAuCA,IAAvC;AMoBP,CAvBD;ANKQ,WAAKM,gBAAL;AMoBRe,ANnBK,eMmBIC,cAAT,CAAwBiC,gBAAxB,CAAyC,OAAzC,EAAkD,UAAAC,CAAC,EAAI;AACrD,MAAIA,CAAC,CAACC,OAAF,KAAc,EAAlB,EAAsB;AACpBT,IAAAA,kBAAkB,CAACQ,CAAC,CAACE,MAAF,CAASC,OAAT,CAAiB7D,EAAlB,CAAlB;sCNnBkBA,IAAIE,MAAK;AMoB3BqB,ANnBI,UAAMd,SMmBDe,INnBc,GAAG,KAAKzB,EMmB/B,CAAwB+D,QNnBE,CAAiBnD,IAAjB,CAAsB,CMmBhD,CAAwC,QNnBQC,CMmBhD,ONnBwD;AMoBzD,ANpByD,eAAIA,QAAQ,CAACZ,EAAT,IAAeA,EAAnB;AMqB3D,ANrB2D,CMgB5D,MNhB8B,CAAtB;AAEAS,MAAAA,aAAa,CAACP,IAAd,GAAqBA,IAArB;AMqBRqB,ANpBQd,MAAAA,SMoBCV,INpBY,CAACc,MMoBtB,CAAqB4C,ANpBb,GAAwB,IAAxB,SMoBR,CAAsC,OAAtC,EAA+C,UAAAC,CAAC,EAAI;AAClDA,EAAAA,CAAC,CAACK,cAAF;AACA,ANpBM,MMoBFL,CAAC,CAACE,GNpBKpD,GMoBP,CAASwD,OAAT,KAAqB,ANpBnB,QMoBN,EAAmC;AAEnC,ANrBG,MMqBGC,GAAG,GAAGP,CAAC,CAACE,MAAd;AACA,MAAM5D,EAAE,GAAGiE,GAAG,CAACJ,OAAJ,CAAY7D,EAAvB;AACA,MAAMkE,EAAE,GAAGzC,QAAQ,CAACC,aAAT,wBAAsC1B,EAAtC,SAAX;kCNtBgBA,IAAG;AMuBnB,ANtBM,MMsBFiE,GAAG,CAACE,ANtBIrD,SMsBR,CAAcsD,QAAd,ANtB0B,CMsBH,ENtBM,KAAKrE,WAAL,CAAiBgB,CMsB9C,CAAJ,EAAkD,ENtBjB,CAAwB,UAAAH,QAAQ;AMuB/DsD,ANvB+D,IMuB/DA,EAAE,CAACG,QNvBgEzD,QAAQ,CAACZ,EAAT,EMuBnE,CAAyB,CNvByDA,EAAnB,OMuB/D,EAAqCuB,eAASC,cAA9C;ANvB+D,OAAhC,CAA3B;AMyBJD,ANvBI,WAAKxB,QMuBAyB,GNvBL,GAAmBV,QMuBvB,CAAwBwD,KAAxB,INvBI;AACA;AMuBJ/C,mBAASC,cAAT,CAAwB+C,YAAxB,CAAqC,SAArC,EAAgDvE,EAAhD;AACD,ANvBK,WAAKQ,gBAAL;AACH;AMwBH,MAAIyD,GAAG,CAACE,SAAJ,CAAcC,QAAd,CAAuB,qBAAvB,CAAJ,EAAmD;AACjD,QAAI,CAACI,OAAO,CAAC,mCAAD,CAAZ,EAAmD;AACnD,QAAMC,WAAW,GAAG,iBNxBF,cMwBlB;AACAxB,ANxBIjC,IMwBJiC,ENxBIjC,GMwBC,CAACjB,QNxBU,CAACkB,EMwBjB,CAAkByD,INxBd,CAAqB,YMwBzB,CAAoC1E,ANxBhC,EMwBJ,ANxBwCkB,EMwBAuD,ENxBI,CAACtD,QMwB7C,CNxBwC,CAAe,KAAKpB,WAApB,CAApC;AMyBJmE,ANxBC,IMwBDA,EAAE,CAACxC,aAAH,CAAiB,YAAjB,EAA+BiD,SAA/B,GAA2CF,WAA3C;AACAf,IAAAA,CAAC,CAACE,MAAF,CAASgB,MAAT;AACD;AACF,CArBD,iCNJiB;AAET,UAAMxD,OAAO,GAAGF,IAAI,CAACG,KAAL,CAAWL,YAAY,CAACM,OAAb,CAAqB,aAArB,CAAX,CAAhB;AMyBRuD,ANxBQ,MMwBF,CAACpB,GNxBKrC,OAAJ,EAAa,IMwBrB,CAAwB,ANxBErB,MMwB1B,EAAgC,GNxBX,GAAmBqB,IMwBRsC,CAAC,EAAI,ANxBhB;AMyBnBT,ANxBG,EMwBHA,KAAK,CAAClD,WAAN,GAAoB,IAAIqD,oBAAJ,EAApB;AAEAH,EAAAA,KAAK,CAAClD,WAAN,CAAkB+E,WAAlB,GAHmC,CAKnC;;AALmC;AAAA;AAAA;;AAAA;AAMnC,yBAAoB7B,KAAK,CAAClD,WAAN,CAAkBA,WAAtC,8HAAmD;AAAA,UAA1CM,OAA0C;AACjD0E,MAAAA,OAAO,CAACC,GAAR,CAAY3E,OAAZ;AADiD,UAEzCL,EAFyC,GAEKK,OAFL,CAEzCL,EAFyC;AAAA,UAErCC,QAFqC,GAEKI,OAFL,CAErCJ,QAFqC;AAAA,UAErBgC,WAFqB,GAEK5B,OAFL,CAE3BH,IAF2B;AAAA,UAERE,QAFQ,GAEKC,OAFL,CAERD,QAFQ;;AAGjD,UAAIA,QAAJ,EAAc;AACZmD,QAAAA,eAAe,CAAClB,2BAAhB,CACErC,EADF,EAEEC,QAFF,EAGEgC,WAHF,EAIE7B,QAJF,EAKE8B,cALF;AAOD,OARD,MAQO;AACLqB,QAAAA,eAAe,CAACvB,mBAAhB,CAAoChC,EAApC,EAAwCC,QAAxC,EAAkDgC,WAAlD,EAA+DuB,SAA/D,EAA0EtB,cAA1E;AACD;AACF;AApBkC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAqBpC,CArBD;AAwBA;;;;AAIC,IAAMA,cAAc,GAAG,SAAjBA,cAAiB,CAAClC,EAAD,EAAQ;AAC3B,MAAMK,OAAO,GAAG4C,KAAK,CAAClD,WAAN,CAAkBA,WAAlB,CAA8BY,IAA9B,CAAmC,UAAAsE,CAAC;AAAA,WAAIA,CAAC,CAACjF,EAAF,IAAQA,EAAZ;AAAA,GAApC,CAAhB;AAEA,MAAIkF,MAAM,4DAAkDlF,EAAlD,sBAAV;;AACA,MAAIK,OAAO,IAAI,CAACA,OAAO,CAACQ,OAAxB,EAAiC;AAC/BqE,IAAAA,MAAM,8DAAoDlF,EAApD,uBAAN;AACD;;AACD,SAAOkF,MAAP;AACJ,CARA","file":"app.c3f9f951.js","sourceRoot":"..","sourcesContent":["export default class commentList {\n    constructor(){\n        this.commentList = [];\n    }\n\n    addComment(id, username, text, child, parentId){\n        const comment = {\n            id,\n            username,\n            text,\n            child: !!child,\n            parent: !!parentId,\n            parentId\n        };\n        this.commentList.push(comment);\n        this._persistComments();\n    }\n\n    editComment(id, text){\n        const updateComment = this.commentList.indexOf(id);\n\n        // @todo: try to follow immutability over here\n        this.commentList[updateComment].text = text;\n\n        this._persistComments();\n    }\n\n    softDeleteComment(id, text){\n        const updateComment = this.commentList.find(listItem => listItem.id == id);\n\n        updateComment.text = text;\n        updateComment.deleted = true;\n\n        this._persistComments();\n    }\n    deleteComment(id){\n        const updatedCommentList = this.commentList.filter(listItem => listItem.id == id);\n\n        this.commentList = updatedCommentList;\n        debugger\n        this._persistComments();\n    }\n\n    _persistComments(){\n        localStorage.setItem('commentList', JSON.stringify(this.commentList));\n    }\n\n    readStorage(){\n        \n        const storage = JSON.parse(localStorage.getItem('commentList'));\n        if (storage) this.commentList = storage;\n    }\n\n}","export const elements = {\n    commentTextbox: document.querySelector('.comment__box'),\n    commentList: document.querySelector('.comment__list')\n};","const getAvatar = (username) => {\r\n    const avatars = {\r\n        'Ashish': 'http://easycomment.akbilisim.com/demo/app/upload/member/avatar/ec-user14-95cbccd215b174-s.jpg',\r\n        'Ravi': 'http://easycomment.akbilisim.com/demo/app/upload/member/avatar/ec-user2-565b4bb4c813ca-s.jpg',\r\n        'Suraj': 'http://easycomment.akbilisim.com/demo/app/upload/member/avatar/ec-user13-19873725ed76e2-s.jpg',\r\n        'Saru': 'http://easycomment.akbilisim.com/demo/app/upload/member/avatar/ec-user19-7966a1b638bd69-s.jpg',\r\n        'Mano': 'http://easycomment.akbilisim.com/demo/app/upload/member/avatar/ec-user18-1881baeccb7399-s.jpg',\r\n        'Debo': 'http://easycomment.akbilisim.com/demo/app/upload/member/avatar/ec-user17-919635985f2132-s.jpg'\r\n    }\r\n\r\n    return avatars[username];\r\n};\r\n\r\nexport default getAvatar;","import {elements} from \"./base\";\nimport getAvatar from '../helper/getAvatar'\nexport const getInput = () => elements.commentTextbox.value;\n\nexport const clearInput = () => {\n    elements.commentTextbox.value = '';\n};\n\nexport const renderCommentMarkup = (id, username, commentText, child, renderControls) => {\n    const markup = `\n        <li class=\"comment\" data-id=\"${id}\">\n            <div class=\"avatar\">\n                <img src=\"${getAvatar(username)}\" />\n            </div>\n            <div class=\"content\">\n                <a href=\"#\">${username}</a>\n                <p>${commentText}</p>\n                <div>\n                   ${renderControls(id)}\n                </div>\n            </div>\n        </li>\n    `;\n\n    !child && elements.commentList.insertAdjacentHTML('afterbegin', markup);\n\n    return markup;\n};\n\nexport const renderChildrenCommentMarkup = (id, username, commentText, parentCommentId, renderControls) => {\n    const markup = `\n        <ul class=\"comment__list\">\n            ${renderCommentMarkup(id, username, commentText, true, renderControls)}\n        </ul>\n    `;\n    document.querySelector(`li[data-id=\"${parentCommentId}\"]`).insertAdjacentHTML('afterend', markup);\n};\n","const generateUniqueId = () => {\n    const uniqueId = new Date().getTime();\n\n    return uniqueId;\n};\n\nexport default generateUniqueId;","const randomUsername = () => {\n    const usernames = [\n        'Ashish',\n        'Ravi',\n        'Suraj',\n        'Saru',\n        'Mano',\n        'Debo'\n    ];\n\n    return usernames[Math.floor(Math.random() * usernames.length)];\n};\n\nexport default randomUsername;","// Comment List Model\nimport CommentList from './model/CommentList';\n\n// Comment List View\nimport * as commentListView from './view/commentListView';\n\n// Helpers\nimport { elements } from './view/base';\nimport generateUniqueId from './helper/generateUniqueId';\nimport randomUsername from './helper/randomName';\n\n/**\n * Store for comments\n */\nconst state = {};\n\n/**\n * Comment List Controller\n */\nconst controlCommentList = id => {\n  const comment = elements.commentTextbox.value;\n  let username = randomUsername();\n  let randomId = generateUniqueId();\n  if (!state.commentList) state.commentList = new CommentList();\n\n  if (comment) {\n    const isChild = !!id;\n    state.commentList.addComment(randomId, username, comment, isChild, id);\n\n    commentListView.clearInput();\n\n    // @todo: think something else here, it's bad\n    id\n      ? commentListView.renderChildrenCommentMarkup(\n          randomId,\n          username,\n          comment,\n          id,\n          renderControls\n        )\n      : commentListView.renderCommentMarkup(randomId, username, comment, undefined, renderControls);\n  }\n};\n\nelements.commentTextbox.addEventListener('keyup', e => {\n  if (e.keyCode === 13) {\n    controlCommentList(e.target.dataset.id);\n    elements.commentTextbox.removeAttribute('data-id');\n  }\n});\n\nelements.commentList.addEventListener('click', e => {\n  e.preventDefault();\n  if (e.target.tagName !== 'BUTTON') return;\n\n  const btn = e.target;\n  const id = btn.dataset.id;\n  const li = document.querySelector(`li[data-id=\"${id}\"]`);\n  if (btn.classList.contains('comment__reply-btn')) {\n    li.insertAdjacentElement('afterend', elements.commentTextbox);\n\n    elements.commentTextbox.focus();\n    elements.commentTextbox.setAttribute('data-id', id);\n  }\n\n  if (btn.classList.contains('comment__delete-btn')) {\n    if (!confirm('Are you sure to delete this item?')) return;\n    const deletedText = 'This comment has been deleted';\n    state.commentList.softDeleteComment(id, deletedText);\n    li.querySelector('.content p').innerHTML = deletedText;\n    e.target.remove();\n  }\n});\n\nwindow.addEventListener('load', e => {\n  state.commentList = new CommentList();\n\n  state.commentList.readStorage();\n\n  //@todo: render n number of comment here based on config.js\n  for (let comment of state.commentList.commentList) {\n    console.log(comment);\n    const { id, username, text: commentText, parentId } = comment;\n    if (parentId) {\n      commentListView.renderChildrenCommentMarkup(\n        id,\n        username,\n        commentText,\n        parentId,\n        renderControls\n      );\n    } else {\n      commentListView.renderCommentMarkup(id, username, commentText, undefined, renderControls);\n    }\n  }\n});\n\n\n/**\n * Controls\n */\n\n const renderControls = (id) => {\n     const comment = state.commentList.commentList.find(c => c.id == id);\n\n     let output = `<button class=\"comment__reply-btn\" data-id=\"${id}\">Reply</button>`;\n     if (comment && !comment.deleted) {\n       output += `<button class=\"comment__delete-btn\" data-id=\"${id}\">Delete</button>`;\n     }\n     return output;\n}"]}